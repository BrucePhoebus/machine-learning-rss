<?xml version="1.0" encoding="UTF-8"?>
<rss xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
  <channel>
    <title>AlgorithmDog</title>
    <link>http://www.iwgc.cn/list/5566</link>
    <description>AlgorithmDog 讲述机器学习和系统研发的轶事,希望把这些事讲得生动有趣.每周日更新哦.欢迎关注.</description>
    <item>
      <title>在 maven 库中上传你自己开发的第三方包</title>
      <link>http://www.iwgc.cn/link/3886652</link>
      <description>&lt;header class="post-header" style=" margin-bottom: 30px; color: rgb(17, 17, 17) ; ; ; ; ; ; ; "&gt;&lt;h1 class="post-title" itemprop="name headline" style="margin-bottom: 15px; font-size: 42px; letter-spacing: -1px; line-height: 1;"&gt;&lt;/h1&gt;&lt;p&gt;本文是同事 bourneli 的作品。&lt;span&gt;&lt;span&gt;bourneli&amp;nbsp;&lt;/span&gt;出身于湖北武汉。23岁时离开武汉，独自一人来到深圳实习并工作，一直到现在。目前在腾讯工作，花名 &lt;/span&gt;&lt;strong&gt;bourneli。&amp;nbsp;&lt;/strong&gt;&lt;span&gt;可点击原文链接&lt;/span&gt;&lt;span&gt;查看作者博客。&lt;/span&gt;&lt;/p&gt;&lt;p&gt;将开发的通用库上传到mvn库中，其他同学使用会比较方便。本文记录相关配置，以及此过程中遇到的坑。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2 style=" margin-bottom: 15px; font-size: 32px; color: rgb(17, 17, 17) ; ; ; ; ; "&gt;设置全局setting.xml&lt;/h2&gt;&lt;p&gt;settingsx.xml需要添加的记录&lt;/p&gt;&lt;/header&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvOJ0wNq4SPH7fegJRxzeyOHGibzriboYZtNbEMeh4wpic62snepWm46oPR6OKyW7Aso4N4o4lDaAiaPFQ/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;主要是设定两个 server 的 id 和账号，snapshots 用于调试，releases 用于发布。前者版本可以覆盖，后者版本发布后无法覆盖，版本号必须变化。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2 style="margin-bottom: 15px; font-size: 32px;"&gt;设置组件 pom.xml&lt;/h2&gt;&lt;p&gt;组件pom.xml需要添加的记录如下&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvOJ0wNq4SPH7fegJRxzeyOHmfwYu40JicqsGxrvViaOOUnbTjLXOyq3k8QoLdUPvFvuzKm0a7CsXiaJg/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;这里的 &lt;strong&gt;release &lt;/strong&gt;和 &lt;strong&gt;snapshots &lt;/strong&gt;与 setting.xml 对应的。这里的组件 pom.xml 就是要上传到maven库供其他人使用的 pom.xml。设置上面的配置有两个目的：一个是通过id找到账号，第二个是告诉 mvn 上传的具体目录。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2 style="margin-bottom: 15px; font-size: 32px;"&gt;设置调用组件的项目pom.xml&lt;/h2&gt;&lt;p&gt;现在就可以类似引用其他项目一样，添加下面的 dependency&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvOJ0wNq4SPH7fegJRxzeyOHUa4HicN8o6WcCLKtfoic76Sjg8libRClpBusljicFYb4sxr9UzKib0BUMzw/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;但是，还不够，还需要指定第三方 maven 库的配置，否则还是找不到，如下&lt;/p&gt;&lt;p&gt;&lt;img src="https://images.weserv.nl/?url=mmbiz.qpic.cn/mmbiz_png/Q3H1TCddfvOJ0wNq4SPH7fegJRxzeyOHC6r8tuGGXdWOmRFjyy1ERjJ18abx14aLYyricY2aSASDfPLn1fFOnCg/0?wx_fmt=png"/&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;其实，上面的 repository 也可以设置在 setting.xml 中。上面两个 pom.xml 中的url需要保持一致。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2 style="margin-bottom: 15px; font-size: 32px;"&gt;部署 snapshots 包&lt;/h2&gt;&lt;p&gt;使用 mvn 命令部署，需要将本地 maven 配置 path 路径，这样可以在命令行中执行 mvn 命令。可直接用Intellij目录下plugin中的maven3/bin目录即可。&lt;/p&gt;&lt;p&gt;上传本地snapshots包到maven服务器，命令如下&lt;/p&gt;&lt;p&gt;mvn deploy:deploy-file -e&lt;/p&gt;&lt;p&gt;-DgroupId=your.package.id&lt;/p&gt;&lt;p&gt;-DartifactId=your_package_name&lt;/p&gt;&lt;p&gt;-Dversion=1.0.0-SNAPSHOT&lt;/p&gt;&lt;p&gt;-Dpackaging=jar&lt;/p&gt;&lt;p&gt;-Dfile=target/your_package_name-1.0.0-SNAPSHOT.jar&lt;/p&gt;&lt;p&gt;-DrepositoryId=snapshots&lt;/p&gt;&lt;p&gt;-Durl=http://[repo_host]/nexus/content/repositories/thirdparty-snapshots&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;我将上面的命令放到一个脚本中，并且将脚本放到pom.xml同级目录。&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;h2 style="margin-bottom: 15px; font-size: 32px;"&gt;部署releases包&lt;/h2&gt;&lt;p&gt;如果是上传 release 版本，可以使用类似下面的命令，&lt;/p&gt;&lt;p&gt;mvn deploy:deploy-file -e&lt;/p&gt;&lt;p&gt;-DgroupId=your.package.id&lt;/p&gt;&lt;p&gt;-DartifactId=your_package_name&lt;/p&gt;&lt;p&gt;-Dversion=0.0.1&lt;/p&gt;&lt;p&gt;-Dpackaging=jar&lt;/p&gt;&lt;p&gt;-Dfile=target/your_package_name-0.0.1.jar&lt;/p&gt;&lt;p&gt;-DrepositoryId=releases&lt;/p&gt;&lt;p&gt;-Durl=http://[repo_host]/nexus/content/repositories/thirdparty&lt;/p&gt;&lt;p&gt;&lt;br/&gt;&lt;/p&gt;&lt;p&gt;配置时，参数&lt;strong&gt;-DrepositoryId&lt;/strong&gt;写成了&lt;strong&gt;release&lt;/strong&gt;，少写了一个&lt;strong&gt;s&lt;/strong&gt;，导致一直报401错误，这个错误比较有迷惑性。之前一直以为是密码错误，所以一直没有找到问题的根源，后来在yunshandi同学的帮助下，发现原来是打错了id。releases版本，一个版本号只能对应一个jar包，不能覆盖，这样保证版本的稳定性，如果尝试覆盖releases版本，会报400错误。&lt;/p&gt;&lt;p&gt;上传完毕后，可以在maven站点上搜素到相关的包。并且可以在其他工程中应用，非常方便。&lt;/p&gt;&lt;p&gt;最后，感谢同事 AlgorithmDog 和 TEG 同事yunshandi。&lt;/p&gt;&lt;p&gt;再次提醒&lt;span&gt;点击原文链接&lt;/span&gt;&lt;span&gt;查看作者博客哦。&lt;/span&gt;&lt;/p&gt;</description>
      <pubDate>Mon, 12 Dec 2016 19:31:30 +0800</pubDate>
    </item>
  </channel>
</rss>
